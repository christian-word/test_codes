<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë—ñ–±–ª—ñ—è –ê—Å–∏—Å—Ç–µ–Ω—Ç - –°–ø—Ä–æ—â–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞</title>
    <style>
        :root {
            --primary: #1a73e8;
            --bg: #f8f9fa;
            --card: #ffffff;
            --text: #202124;
            --muted: #5f6368;
            --border: #dadce0;
            --hover: #f1f3f4;
            --success: #34a853;
            --danger: #ea4335;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        /* –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .sidebar {
            width: 320px;
            background: var(--card);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
        }

        .sidebar.collapsed {
            transform: translateX(-280px);
            width: 40px;
        }

        .sidebar-header {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar-title {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
        }

        .collapse-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
        }

        .collapse-btn:hover {
            background: var(--hover);
        }

        /* –ï–¥–∏–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞ */
        .search-container {
            padding: 16px;
            border-bottom: 1px solid var(--border);
        }

        .search-box {
            position: relative;
            width: 100%;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px 12px 40px;
            border: 1px solid var(--border);
            border-radius: 24px;
            font-size: 14px;
            outline: none;
            background: var(--hover);
            transition: all 0.2s;
        }

        .search-input:focus {
            background: white;
            border-color: var(--primary);
            box-shadow: 0 2px 5px 1px rgba(64,60,67,.16);
        }

        .search-placeholder {
            position: absolute;
            left: 40px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--muted);
            font-size: 14px;
            pointer-events: none;
            transition: opacity 0.2s;
        }

        .search-input:focus + .search-placeholder,
        .search-input:not(:placeholder-shown) + .search-placeholder {
            opacity: 0;
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--muted);
            font-size: 16px;
        }

        .search-results {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-top: 8px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }

        .search-results.active {
            display: block;
        }

        .search-result {
            padding: 12px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
        }

        .search-result:hover {
            background: var(--hover);
        }

        .search-result:last-child {
            border-bottom: none;
        }

        .result-type {
            font-size: 11px;
            color: var(--muted);
            text-transform: uppercase;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .result-title {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 2px;
        }

        .result-preview {
            font-size: 12px;
            color: var(--muted);
            line-height: 1.3;
        }

        /* –¢–∞–±—ã */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
        }

        .tab {
            flex: 1;
            background: none;
            border: none;
            padding: 12px 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            color: var(--muted);
            position: relative;
        }

        .tab.active {
            color: var(--primary);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary);
        }

        /* –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–æ–≤ */
        .tab-content {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .panel {
            display: none;
        }

        .panel.active {
            display: block;
        }

        /* –≠–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–æ–≤ */
        .list-item {
            padding: 12px;
            margin-bottom: 4px;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .list-item:hover {
            border-color: var(--primary);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .list-item.selected {
            border-color: var(--primary);
            background: rgba(26, 115, 232, 0.04);
        }

        .item-actions {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .list-item:hover .item-actions {
            opacity: 1;
        }

        .action-btn {
            background: var(--hover);
            border: none;
            border-radius: 4px;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .action-btn:hover {
            background: var(--border);
            transform: scale(1.1);
        }

        .action-btn.edit {
            color: var(--primary);
        }

        .action-btn.delete {
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø–æ–∏—Å–∫–∞ */
        mark {
            background: rgba(255, 204, 0, 0.3);
            color: inherit;
            padding: 1px 2px;
            border-radius: 2px;
        }

        .item-title {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .item-meta {
            font-size: 12px;
            color: var(--muted);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .item-category {
            background: var(--primary);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 500;
        }

        .category-study { background: #34a853; }
        .category-prayer { background: #9c27b0; }
        .category-sermon { background: #ff9800; }
        .category-personal { background: #e91e63; }

        /* –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å */
        .main-content {
            flex: 1;
            padding: 20px;
            background: var(--bg);
            position: relative;
        }

        .menu-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 16px;
            display: none;
        }

        .main-content.sidebar-collapsed .menu-toggle {
            display: block;
        }

        /* –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π */
        .action-buttons {
            padding: 16px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 8px;
        }

        .btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-secondary {
            background: var(--hover);
            color: var(--text);
        }

        .btn:hover {
            opacity: 0.9;
        }

        /* –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--muted);
        }

        .empty-state h3 {
            margin: 0 0 8px;
            font-size: 16px;
            font-weight: 500;
        }

        .empty-state p {
            margin: 0;
            font-size: 14px;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .sidebar {
                position: absolute;
                left: 0;
                top: 0;
                height: 100%;
                z-index: 1000;
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content .menu-toggle {
                display: block;
            }

            .overlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                z-index: 999;
                display: none;
            }

            .overlay.active {
                display: block;
            }
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card);
            border-radius: 12px;
            padding: 24px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }

        .form-group.hidden {
            display: none;
        }

        .form-label {
            display: block;
            font-weight: 500;
            margin-bottom: 6px;
            font-size: 14px;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">üìñ –ë—ñ–±–ª—ñ—è –ê—Å–∏—Å—Ç–µ–Ω—Ç</h2>
                <button class="collapse-btn" onclick="toggleSidebar()">‚Äπ</button>
            </div>

            <!-- –ü–æ–∏—Å–∫ –≤ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ -->
            <div class="search-container">
                <div class="search-box">
                    <div class="search-icon">üîç</div>
                    <input type="text" 
                           class="search-input" 
                           id="contextSearch"
                           oninput="performContextSearch(this.value)"
                           placeholder="">
                    <div class="search-placeholder" id="searchPlaceholder">–ü–æ—à—É–∫ —É —Å–µ—Å—ñ—è—Ö...</div>
                </div>
                <div class="search-results" id="searchResults"></div>
            </div>

            <!-- –¢–∞–±—ã -->
            <div class="tabs">
                <button class="tab active" data-tab="sessions" onclick="switchTab('sessions')">
                    üìù –°–µ—Å—ñ—ó
                </button>
                <button class="tab" data-tab="notes" onclick="switchTab('notes')">
                    üîñ –ù–æ—Ç–∞—Ç–∫–∏
                </button>
            </div>

            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
            <div class="tab-content">
                <!-- –ü–∞–Ω–µ–ª—å —Å–µ—Å—Å–∏–π -->
                <div class="panel active" id="sessions-panel">
                    <div id="sessions-list"></div>
                    <div class="empty-state" id="sessions-empty" style="display: none;">
                        <h3>–ù–µ–º–∞—î —Å–µ—Å—ñ–π</h3>
                        <p>–°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É —Å–µ—Å—ñ—é –¥–ª—è –ø–æ—á–∞—Ç–∫—É —Ä–æ–±–æ—Ç–∏</p>
                    </div>
                </div>

                <!-- –ü–∞–Ω–µ–ª—å –∑–∞–º–µ—Ç–æ–∫ -->
                <div class="panel" id="notes-panel">
                    <div id="notes-list"></div>
                    <div class="empty-state" id="notes-empty" style="display: none;">
                        <h3>–ù–µ–º–∞—î –Ω–æ—Ç–∞—Ç–æ–∫</h3>
                        <p>–°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ—Ç–∞—Ç–∫—É –∞–±–æ –∑–∞–∫–ª–∞–¥–∫—É</p>
                    </div>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="createNew()">
                    ‚ûï –°—Ç–≤–æ—Ä–∏—Ç–∏
                </button>
                <button class="btn btn-secondary" onclick="showOptions()">
                    üìÅ –§–∞–π–ª
                </button>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å -->
        <div class="main-content" id="mainContent">
            <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
            
            <h1>–ë—ñ–±–ª—ñ—è –ê—Å–∏—Å—Ç–µ–Ω—Ç</h1>
            <p>–Ñ–•–ë –º.–°—É–º–∏, –£–∫—Ä–∞—ó–Ω–∞</p>
            
            <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç -->
            <div id="chatArea">
                <div style="padding: 40px; text-align: center; color: #666;">
                    <h3>–í—ñ—Ç–∞—î–º–æ —É –ë—ñ–±–ª—ñ–π–Ω–æ–º—É –ê—Å–∏—Å—Ç–µ–Ω—Ç—ñ!</h3>
                    <p>–ü–æ—á–Ω—ñ—Ç—å –Ω–æ–≤—É —Ä–æ–∑–º–æ–≤—É –∞–±–æ –≤–∏–±–µ—Ä—ñ—Ç—å —ñ—Å–Ω—É—é—á—É —Å–µ—Å—ñ—é –∑ –±–æ–∫–æ–≤–æ—ó –ø–∞–Ω–µ–ª—ñ.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- –û–≤–µ—Ä–ª–µ–π –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
    <div class="overlay" id="overlay" onclick="closeSidebar()"></div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è -->
    <div class="modal" id="createModal">
        <div class="modal-content">
            <h3>–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É</h3>
            <div class="form-group">
                <label class="form-label">–¢–∏–ø:</label>
                <select class="form-select" id="createType" onchange="toggleCreateFields()">
                    <option value="session">üìù –ù–æ–≤–∞ —Å–µ—Å—ñ—è</option>
                    <option value="note">üìñ –ù–æ—Ç–∞—Ç–∫–∞</option>
                    <option value="bookmark">üîñ –ó–∞–∫–ª–∞–¥–∫–∞</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">–ù–∞–∑–≤–∞:</label>
                <input type="text" class="form-input" id="createTitle" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É...">
            </div>

            <div id="noteFields" style="display: none;">
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:</label>
                    <select class="form-select" id="createCategory">
                        <option value="study">üìñ –í–∏–≤—á–µ–Ω–Ω—è</option>
                        <option value="prayer">üôè –ú–æ–ª–∏—Ç–≤–∞</option>
                        <option value="sermon">üé§ –ü—Ä–æ–ø–æ–≤—ñ–¥—å</option>
                        <option value="personal">üí≠ –û—Å–æ–±–∏—Å—Ç–µ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">–ë—ñ–±–ª—ñ–π–Ω–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:</label>
                    <input type="text" class="form-input" id="createReference" placeholder="–Ω–∞–ø—Ä: –ü—Å. 23:1-6">
                </div>

                <div class="form-group">
                    <label class="form-label">–ó–º—ñ—Å—Ç:</label>
                    <textarea class="form-textarea" id="createContent" placeholder="–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç..."></textarea>
                </div>
            </div>

            <div class="form-actions">
                <button class="btn btn-secondary" onclick="closeModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button class="btn btn-primary" onclick="createItem()">–°—Ç–≤–æ—Ä–∏—Ç–∏</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏ -->
    <div class="modal" id="editSessionModal">
        <div class="modal-content">
            <h3>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Å–µ—Å—ñ—é</h3>
            <div class="form-group">
                <label class="form-label">–ù–∞–∑–≤–∞:</label>
                <input type="text" class="form-input" id="editSessionTitle" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Å–µ—Å—ñ—ó...">
            </div>
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="closeModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button class="btn btn-danger" onclick="confirmDeleteCurrentSession()">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                <button class="btn btn-primary" onclick="saveSessionEdit()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–º–µ—Ç–∫–∏ -->
    <div class="modal" id="editNoteModal">
        <div class="modal-content">
            <h3>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –Ω–æ—Ç–∞—Ç–∫—É</h3>
            <div class="form-group">
                <label class="form-label">–ù–∞–∑–≤–∞:</label>
                <input type="text" class="form-input" id="editNoteTitle" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É...">
            </div>
            
            <div id="editNoteFields">
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:</label>
                    <select class="form-select" id="editNoteCategory" onchange="toggleEditNoteFields()">
                        <option value="">üîñ –ó–∞–∫–ª–∞–¥–∫–∞</option>
                        <option value="study">üìñ –í–∏–≤—á–µ–Ω–Ω—è</option>
                        <option value="prayer">üôè –ú–æ–ª–∏—Ç–≤–∞</option>
                        <option value="sermon">üé§ –ü—Ä–æ–ø–æ–≤—ñ–¥—å</option>
                        <option value="personal">üí≠ –û—Å–æ–±–∏—Å—Ç–µ</option>
                    </select>
                </div>

                <div class="form-group" id="editNoteReferenceGroup">
                    <label class="form-label">–ë—ñ–±–ª—ñ–π–Ω–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:</label>
                    <input type="text" class="form-input" id="editNoteReference" placeholder="–Ω–∞–ø—Ä: –ü—Å. 23:1-6">
                </div>

                <div class="form-group" id="editNoteContentGroup">
                    <label class="form-label">–ó–º—ñ—Å—Ç:</label>
                    <textarea class="form-textarea" id="editNoteContent" placeholder="–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç..."></textarea>
                </div>
            </div>

            <div class="form-actions">
                <button class="btn btn-secondary" onclick="closeModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button class="btn btn-danger" onclick="confirmDeleteCurrentNote()">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                <button class="btn btn-primary" onclick="saveNoteEdit()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
        </div>
    </div>
    <div class="modal" id="optionsModal">
        <div class="modal-content">
            <h3>–û–ø—Ü—ñ—ó</h3>
            <div style="display: flex; flex-direction: column; gap: 12px;">
                <button class="btn btn-secondary" onclick="exportData()">üì§ –ï–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö</button>
                <button class="btn btn-secondary" onclick="importData()">üì• –Ü–º–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö</button>
                <button class="btn btn-secondary" onclick="clearAll()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å–µ</button>
                <button class="btn btn-primary" onclick="closeModal()">–ó–∞–∫—Ä–∏—Ç–∏</button>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let appData = {
            sessions: [
                {
                    id: 'session_1',
                    title: '–†–∞–∑–º—ã—à–ª–µ–Ω–∏—è –æ –ü—Å–∞–ª–º–µ 23',
                    created: Date.now() - 86400000,
                    modified: Date.now() - 3600000,
                    messageCount: 12
                },
                {
                    id: 'session_2', 
                    title: '–ú–æ–ª–∏—Ç–≤–∞ –æ –º—É–¥—Ä–æ—Å—Ç–∏',
                    created: Date.now() - 172800000,
                    modified: Date.now() - 7200000,
                    messageCount: 8
                }
            ],
            notes: [
                {
                    id: 'note_1',
                    type: 'note',
                    title: '–ó–∞–º–µ—Ç–∫–∞ –æ –ª—é–±–≤–∏ –ë–æ–∂—å–µ–π',
                    content: '–†–∞–∑–º—ã—à–ª–µ–Ω–∏—è –Ω–∞–¥ —Å—Ç–∏—Ö–æ–º –Ü–≤. 3:16 - "–¢–∞–∫ –≤–æ–∑–ª—é–±–∏–ª –ë–æ–≥ –º–∏—Ä..."',
                    category: 'study',
                    bibleRef: '–Ü–≤. 3:16',
                    created: Date.now() - 259200000,
                    sessionId: null
                },
                {
                    id: 'note_2',
                    type: 'bookmark',
                    title: '–í–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ –±–µ—Å–µ–¥–µ',
                    content: '',
                    category: null,
                    bibleRef: '',
                    created: Date.now() - 86400000,
                    sessionId: 'session_1'
                }
            ],
            currentTab: 'sessions',
            selectedItem: null
        };

        // –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è–º–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–º–µ—Ç–∫–∏
        function toggleEditNoteFields() {
            const category = document.getElementById('editNoteCategory').value;
            const referenceGroup = document.getElementById('editNoteReferenceGroup');
            const contentGroup = document.getElementById('editNoteContentGroup');
            
            if (category === '') {
                // –≠—Ç–æ –∑–∞–∫–ª–∞–¥–∫–∞ - —Å–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª—è
                referenceGroup.classList.add('hidden');
                contentGroup.classList.add('hidden');
            } else {
                // –≠—Ç–æ –∑–∞–º–µ—Ç–∫–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—è
                referenceGroup.classList.remove('hidden');
                contentGroup.classList.remove('hidden');
            }
        }

        // –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –ø–æ–∏—Å–∫ (–≤ —Ä–∞–º–∫–∞—Ö –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏)
        function performContextSearch(query) {
            const results = document.getElementById('searchResults');
            const searchInput = document.getElementById('contextSearch');
            
            if (!query.trim()) {
                results.classList.remove('active');
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                renderCurrentTab();
                return;
            }

            const searchResults = [];
            query = query.toLowerCase();

            if (appData.currentTab === 'sessions') {
                // –ü–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –≤ —Å–µ—Å—Å–∏—è—Ö
                appData.sessions.forEach(session => {
                    if (session.title.toLowerCase().includes(query)) {
                        searchResults.push({
                            type: '—Å–µ—Å—ñ—è',
                            id: session.id,
                            title: session.title,
                            preview: `${session.messageCount} –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å ‚Ä¢ ${formatDate(session.modified)}`
                        });
                    }
                });
            } else {
                // –ü–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –≤ –∑–∞–º–µ—Ç–∫–∞—Ö
                appData.notes.forEach(note => {
                    if (note.title.toLowerCase().includes(query) || 
                        note.content.toLowerCase().includes(query) ||
                        (note.bibleRef && note.bibleRef.toLowerCase().includes(query))) {
                        searchResults.push({
                            type: note.type === 'bookmark' ? '–∑–∞–∫–ª–∞–¥–∫–∞' : '–Ω–æ—Ç–∞—Ç–∫–∞',
                            id: note.id,
                            title: note.title,
                            preview: note.content ? note.content.substring(0, 60) + '...' : note.bibleRef
                        });
                    }
                });
            }

            renderContextSearchResults(searchResults, query);
        }

        function renderContextSearchResults(results, query) {
            const container = document.getElementById('searchResults');
            
            if (results.length === 0) {
                container.innerHTML = '<div class="search-result"><div class="result-preview">–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</div></div>';
            } else {
                container.innerHTML = results.map(result => `
                    <div class="search-result" onclick="selectContextSearchResult('${result.id}')">
                        <div class="result-type">${result.type}</div>
                        <div class="result-title">${highlightSearchTerm(result.title, query)}</div>
                        <div class="result-preview">${result.preview}</div>
                    </div>
                `).join('');
            }
            
            container.classList.add('active');
        }

        function highlightSearchTerm(text, term) {
            if (!term) return text;
            const regex = new RegExp(`(${term})`, 'gi');
            return text.replace(regex, '<mark>$1</mark>');
        }

        function selectContextSearchResult(id) {
            document.getElementById('searchResults').classList.remove('active');
            document.getElementById('contextSearch').value = '';
            
            if (appData.currentTab === 'sessions') {
                selectSession(id);
            } else {
                selectNote(id);
            }
        }

        function updateSearchPlaceholder() {
            const placeholder = document.getElementById('searchPlaceholder');
            if (appData.currentTab === 'sessions') {
                placeholder.textContent = '–ü–æ—à—É–∫ —É —Å–µ—Å—ñ—è—Ö...';
            } else {
                placeholder.textContent = '–ü–æ—à—É–∫ —É –Ω–æ—Ç–∞—Ç–∫–∞—Ö...';
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
        function switchTab(tabName) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —Ç–∞–±
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –ø–∞–Ω–µ–ª—å
            document.querySelectorAll('.panel').forEach(panel => panel.classList.remove('active'));
            document.getElementById(`${tabName}-panel`).classList.add('active');

            appData.currentTab = tabName;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä –ø–æ–∏—Å–∫–∞
            updateSearchPlaceholder();
            
            // –û—á–∏—â–∞–µ–º –ø–æ–∏—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
            document.getElementById('contextSearch').value = '';
            document.getElementById('searchResults').classList.remove('active');
            
            renderCurrentTab();
        }

        function renderCurrentTab() {
            if (appData.currentTab === 'sessions') {
                renderSessions();
            } else {
                renderNotes();
            }
        }

        function renderSessions() {
            const container = document.getElementById('sessions-list');
            const empty = document.getElementById('sessions-empty');

            if (appData.sessions.length === 0) {
                container.innerHTML = '';
                empty.style.display = 'block';
                return;
            }

            empty.style.display = 'none';
            container.innerHTML = appData.sessions.map(session => `
                <div class="list-item ${appData.selectedItem === session.id ? 'selected' : ''}" 
                     onclick="selectSession('${session.id}')">
                    <div class="item-actions">
                        <button class="action-btn edit" onclick="event.stopPropagation(); editSession('${session.id}')" title="–†–µ–¥–∞–≥—É–≤–∞—Ç–∏">
                            ‚úèÔ∏è
                        </button>
                        <button class="action-btn delete" onclick="event.stopPropagation(); deleteSession('${session.id}')" title="–í–∏–¥–∞–ª–∏—Ç–∏">
                            üóëÔ∏è
                        </button>
                    </div>
                    <div class="item-title">${session.title}</div>
                    <div class="item-meta">
                        <span>${session.messageCount} –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å</span>
                        <span>${formatDate(session.modified)}</span>
                    </div>
                </div>
            `).join('');
        }

        function renderNotes() {
            const container = document.getElementById('notes-list');
            const empty = document.getElementById('notes-empty');

            if (appData.notes.length === 0) {
                container.innerHTML = '';
                empty.style.display = 'block';
                return;
            }

            empty.style.display = 'none';
            container.innerHTML = appData.notes.map(note => {
                const categoryNames = {
                    study: 'üìñ –í–∏–≤—á–µ–Ω–Ω—è',
                    prayer: 'üôè –ú–æ–ª–∏—Ç–≤–∞',
                    sermon: 'üé§ –ü—Ä–æ–ø–æ–≤—ñ–¥—å',
                    personal: 'üí≠ –û—Å–æ–±–∏—Å—Ç–µ'
                };

                return `
                    <div class="list-item ${appData.selectedItem === note.id ? 'selected' : ''}" 
                         onclick="selectNote('${note.id}')">
                        <div class="item-actions">
                            <button class="action-btn edit" onclick="event.stopPropagation(); editNote('${note.id}')" title="–†–µ–¥–∞–≥—É–≤–∞—Ç–∏">
                                ‚úèÔ∏è
                            </button>
                            <button class="action-btn delete" onclick="event.stopPropagation(); deleteNote('${note.id}')" title="–í–∏–¥–∞–ª–∏—Ç–∏">
                                üóëÔ∏è
                            </button>
                        </div>
                        <div class="item-title">${note.title}</div>
                        ${note.content ? `<div class="result-preview">${note.content.substring(0, 80)}...</div>` : ''}
                        <div class="item-meta">
                            ${note.category ? `<span class="item-category category-${note.category}">${categoryNames[note.category]}</span>` : 
                              `<span class="item-category">üîñ –ó–∞–∫–ª–∞–¥–∫–∞</span>`}
                            <span>${formatDate(note.created)}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function selectSession(id) {
            appData.selectedItem = id;
            renderSessions();
            console.log('–í—ã–±—Ä–∞–Ω–∞ —Å–µ—Å—Å–∏—è:', id);
        }

        function selectNote(id) {
            appData.selectedItem = id;
            renderNotes();
            console.log('–í—ã–±—Ä–∞–Ω–∞ –∑–∞–º–µ—Ç–∫–∞:', id);
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª—å—é
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            const overlay = document.getElementById('overlay');

            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            } else {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('sidebar-collapsed');
            }
        }

        function closeSidebar() {
            document.getElementById('sidebar').classList.remove('open');
            document.getElementById('overlay').classList.remove('active');
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
        function createNew() {
            const modal = document.getElementById('createModal');
            modal.classList.add('active');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∏–ø –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–∞–±–∞
            const typeSelect = document.getElementById('createType');
            typeSelect.value = appData.currentTab === 'sessions' ? 'session' : 'note';
            toggleCreateFields();
        }

        function toggleCreateFields() {
            const type = document.getElementById('createType').value;
            const noteFields = document.getElementById('noteFields');
            noteFields.style.display = type === 'session' ? 'none' : 'block';
        }

        function createItem() {
            const type = document.getElementById('createType').value;
            const title = document.getElementById('createTitle').value.trim();
            
            if (!title) {
                alert('–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É!');
                return;
            }

            const newItem = {
                id: `${type}_${Date.now()}`,
                title: title,
                created: Date.now(),
                modified: Date.now()
            };

            if (type === 'session') {
                newItem.messageCount = 0;
                appData.sessions.unshift(newItem);
                switchTab('sessions');
                appData.selectedItem = newItem.id;
            } else {
                newItem.type = type;
                newItem.content = document.getElementById('createContent').value.trim();
                newItem.category = type === 'bookmark' ? null : document.getElementById('createCategory').value;
                newItem.bibleRef = document.getElementById('createReference').value.trim();
                newItem.sessionId = null;
                
                appData.notes.unshift(newItem);
                switchTab('notes');
                appData.selectedItem = newItem.id;
            }

            saveData();
            renderCurrentTab();
            closeModal();
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
        let currentEditingSessionId = null;
        let currentEditingNoteId = null;

        function editSession(id) {
            const session = appData.sessions.find(s => s.id === id);
            if (!session) return;

            currentEditingSessionId = id;
            document.getElementById('editSessionTitle').value = session.title;
            document.getElementById('editSessionModal').classList.add('active');
        }

        function saveSessionEdit() {
            if (!currentEditingSessionId) return;

            const title = document.getElementById('editSessionTitle').value.trim();
            if (!title) {
                alert('–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Å–µ—Å—ñ—ó!');
                return;
            }

            const session = appData.sessions.find(s => s.id === currentEditingSessionId);
            if (session) {
                session.title = title;
                session.modified = Date.now();
                saveData();
                renderSessions();
                closeModal();
            }
        }

        function deleteSession(id) {
            if (confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Å–µ—Å—ñ—é? –£—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–¥—É—Ç—å –≤—Ç—Ä–∞—á–µ–Ω—ñ!')) {
                appData.sessions = appData.sessions.filter(s => s.id !== id);
                
                // –£–¥–∞–ª—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
                appData.notes = appData.notes.filter(n => n.sessionId !== id);
                
                if (appData.selectedItem === id) {
                    appData.selectedItem = null;
                }
                
                saveData();
                renderSessions();
                if (appData.currentTab === 'notes') {
                    renderNotes(); // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–º–µ—Ç–∫–∏, –µ—Å–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
                }
            }
        }

        function confirmDeleteCurrentSession() {
            if (currentEditingSessionId) {
                closeModal();
                deleteSession(currentEditingSessionId);
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∞–º–∏
        function editNote(id) {
            const note = appData.notes.find(n => n.id === id);
            if (!note) return;

            currentEditingNoteId = id;
            document.getElementById('editNoteTitle').value = note.title;
            document.getElementById('editNoteCategory').value = note.category || '';
            document.getElementById('editNoteReference').value = note.bibleRef || '';
            document.getElementById('editNoteContent').value = note.content || '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            toggleEditNoteFields();
            
            document.getElementById('editNoteModal').classList.add('active');
        }

        function saveNoteEdit() {
            if (!currentEditingNoteId) return;

            const title = document.getElementById('editNoteTitle').value.trim();
            if (!title) {
                alert('–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –Ω–æ—Ç–∞—Ç–∫–∏!');
                return;
            }

            const note = appData.notes.find(n => n.id === currentEditingNoteId);
            if (note) {
                note.title = title;
                const category = document.getElementById('editNoteCategory').value || null;
                note.category = category;
                
                if (category) {
                    // –≠—Ç–æ –∑–∞–º–µ—Ç–∫–∞ - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –ø–æ–ª—è
                    note.bibleRef = document.getElementById('editNoteReference').value.trim();
                    note.content = document.getElementById('editNoteContent').value.trim();
                    note.type = 'note';
                } else {
                    // –≠—Ç–æ –∑–∞–∫–ª–∞–¥–∫–∞ - –æ—á–∏—â–∞–µ–º –ø–æ–ª—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
                    note.bibleRef = '';
                    note.content = '';
                    note.type = 'bookmark';
                }
                
                note.modified = Date.now();
                
                saveData();
                renderNotes();
                closeModal();
            }
        }

        function deleteNote(id) {
            const note = appData.notes.find(n => n.id === id);
            if (!note) return;

            const typeName = note.type === 'bookmark' ? '–∑–∞–∫–ª–∞–¥–∫—É' : '–Ω–æ—Ç–∞—Ç–∫—É';
            if (confirm(`–í–∏–¥–∞–ª–∏—Ç–∏ ${typeName} "${note.title}"?`)) {
                appData.notes = appData.notes.filter(n => n.id !== id);
                
                if (appData.selectedItem === id) {
                    appData.selectedItem = null;
                }
                
                saveData();
                renderNotes();
            }
        }

        function confirmDeleteCurrentNote() {
            if (currentEditingNoteId) {
                closeModal();
                deleteNote(currentEditingNoteId);
            }
        }

        function closeModal() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('active');
            });
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—ã
            document.getElementById('createTitle').value = '';
            document.getElementById('createContent').value = '';
            document.getElementById('createReference').value = '';
            
            // –£–±–∏—Ä–∞–µ–º —Å–∫—Ä—ã—Ç–∏–µ –ø–æ–ª–µ–π –≤ —Ñ–æ—Ä–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            document.getElementById('editNoteReferenceGroup').classList.remove('hidden');
            document.getElementById('editNoteContentGroup').classList.remove('hidden');
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            currentEditingSessionId = null;
            currentEditingNoteId = null;
        }

        function showOptions() {
            document.getElementById('optionsModal').classList.add('active');
        }

        // –£—Ç–∏–ª–∏—Ç—ã
        function formatDate(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diffInHours = Math.floor((now - date) / (1000 * 60 * 60));
            
            if (diffInHours < 1) return '—â–æ–π–Ω–æ';
            if (diffInHours < 24) return `${diffInHours} –≥–æ–¥ —Ç–æ–º—É`;
            if (diffInHours < 48) return '–≤—á–æ—Ä–∞';
            
            return date.toLocaleDateString('uk-UA', { 
                day: 'numeric', 
                month: 'short' 
            });
        }

        function saveData() {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ä–µ–∫—Ç –≤ –ø–∞–º—è—Ç–∏ –≤–º–µ—Å—Ç–æ localStorage –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å Claude.ai
            console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:', appData);
        }

        function loadData() {
            // –í Claude.ai artifacts –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–∞–º—è—Ç–∏
            console.log('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', appData);
        }

        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `bible_assistant_backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            URL.revokeObjectURL(url);
            closeModal();
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const importedData = JSON.parse(e.target.result);
                            appData = { ...appData, ...importedData };
                            saveData();
                            renderCurrentTab();
                            alert('–î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ!');
                            closeModal();
                        } catch (error) {
                            alert('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —ñ–º–ø–æ—Ä—Ç—ñ —Ñ–∞–π–ª—É!');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            
            input.click();
        }

        function clearAll() {
            if (confirm('–í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ –¥–∞–Ω—ñ? –¶—é –¥—ñ—é –Ω–µ–º–æ–∂–ª–∏–≤–æ —Å–∫–∞—Å—É–≤–∞—Ç–∏!')) {
                appData.sessions = [];
                appData.notes = [];
                appData.selectedItem = null;
                saveData();
                renderCurrentTab();
                closeModal();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateSearchPlaceholder();
            renderCurrentTab();
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∏—Å–∫–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.search-container')) {
                    document.getElementById('searchResults').classList.remove('active');
                }
            });
            
            // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
            document.addEventListener('keydown', function(e) {
                // Ctrl/Cmd + K - —Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–∏—Å–∫
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('contextSearch').focus();
                }
                
                // Escape - –∑–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫–∏ –∏ –ø–æ–∏—Å–∫
                if (e.key === 'Escape') {
                    closeModal();
                    document.getElementById('searchResults').classList.remove('active');
                    document.getElementById('contextSearch').blur();
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∏—Å–∫ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                    document.getElementById('contextSearch').value = '';
                    renderCurrentTab();
                }
                
                // Ctrl/Cmd + N - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
                if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                    e.preventDefault();
                    createNew();
                }
            });
            
            // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ (–≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–µ —Å localStorage)
            setInterval(saveData, 30000);
        });

        // API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –æ—Å–Ω–æ–≤–Ω—ã–º —á–∞—Ç–æ–º
        window.BibleAssistantAPI = {
            // –°–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é
            createSession: function(title) {
                const session = {
                    id: `session_${Date.now()}`,
                    title: title || '–ù–æ–≤–∞ —Å–µ—Å—ñ—è',
                    created: Date.now(),
                    modified: Date.now(),
                    messageCount: 0
                };
                
                appData.sessions.unshift(session);
                saveData();
                
                if (appData.currentTab === 'sessions') {
                    renderSessions();
                }
                
                return session.id;
            },
            
            // –°–æ–∑–¥–∞—Ç—å –∑–∞–º–µ—Ç–∫—É –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞
            createNoteFromMessage: function(messageContent, sessionId, title) {
                const note = {
                    id: `note_${Date.now()}`,
                    type: 'note',
                    title: title || messageContent.substring(0, 50) + '...',
                    content: messageContent,
                    category: 'study',
                    bibleRef: '',
                    created: Date.now(),
                    sessionId: sessionId
                };
                
                appData.notes.unshift(note);
                saveData();
                
                if (appData.currentTab === 'notes') {
                    renderNotes();
                }
                
                return note.id;
            },
            
            // –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–ª–∞–¥–∫—É
            createBookmark: function(title, sessionId) {
                const bookmark = {
                    id: `bookmark_${Date.now()}`,
                    type: 'bookmark',
                    title: title,
                    content: '',
                    category: null,
                    bibleRef: '',
                    created: Date.now(),
                    sessionId: sessionId
                };
                
                appData.notes.unshift(bookmark);
                saveData();
                
                if (appData.currentTab === 'notes') {
                    renderNotes();
                }
                
                return bookmark.id;
            },
            
            // –û–±–Ω–æ–≤–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ—Å—Å–∏–∏
            updateSessionMessageCount: function(sessionId, count) {
                const session = appData.sessions.find(s => s.id === sessionId);
                if (session) {
                    session.messageCount = count;
                    session.modified = Date.now();
                    saveData();
                    
                    if (appData.currentTab === 'sessions') {
                        renderSessions();
                    }
                }
            },
            
            // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
            getData: function() {
                return appData;
            },
            
            // –ü–æ–∏—Å–∫ –≤ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ
            search: function(query) {
                document.getElementById('contextSearch').value = query;
                performContextSearch(query);
            },
            
            // –£–¥–∞–ª–∏—Ç—å —Å–µ—Å—Å–∏—é
            deleteSession: function(sessionId) {
                const index = appData.sessions.findIndex(s => s.id === sessionId);
                if (index !== -1) {
                    appData.sessions.splice(index, 1);
                    // –£–¥–∞–ª—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
                    appData.notes = appData.notes.filter(n => n.sessionId !== sessionId);
                    saveData();
                    renderCurrentTab();
                    return true;
                }
                return false;
            },
            
            // –£–¥–∞–ª–∏—Ç—å –∑–∞–º–µ—Ç–∫—É
            deleteNote: function(noteId) {
                const index = appData.notes.findIndex(n => n.id === noteId);
                if (index !== -1) {
                    appData.notes.splice(index, 1);
                    saveData();
                    if (appData.currentTab === 'notes') {
                        renderNotes();
                    }
                    return true;
                }
                return false;
            },
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Å—Å–∏—é
            editSession: function(sessionId, newTitle) {
                const session = appData.sessions.find(s => s.id === sessionId);
                if (session) {
                    session.title = newTitle;
                    session.modified = Date.now();
                    saveData();
                    if (appData.currentTab === 'sessions') {
                        renderSessions();
                    }
                    return true;
                }
                return false;
            },
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–º–µ—Ç–∫—É
            editNote: function(noteId, updates) {
                const note = appData.notes.find(n => n.id === noteId);
                if (note) {
                    Object.assign(note, updates, { modified: Date.now() });
                    saveData();
                    if (appData.currentTab === 'notes') {
                        renderNotes();
                    }
                    return true;
                }
                return false;
            },
            
            switchToTab: function(tabName) {
                switchTab(tabName);
            },
            
            // –í—ã–±—Ä–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç
            selectItem: function(type, id) {
                if (type === 'session') {
                    switchTab('sessions');
                    selectSession(id);
                } else if (type === 'note') {
                    switchTab('notes');
                    selectNote(id);
                }
            }
        };

        console.log('–ë—ñ–±–ª—ñ—è –ê—Å–∏—Å—Ç–µ–Ω—Ç —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ');
        console.log('API –¥–æ—Å—Ç—É–ø–Ω–µ —á–µ—Ä–µ–∑ window.BibleAssistantAPI');
    </script>
</body>
</html>