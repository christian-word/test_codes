<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Музыкальная Коллекция</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.12);
            border-radius: 25px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ffeb3b, #ff9800);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .auth-section {
            background: rgba(255, 255, 255, 0.15);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 25px;
            text-align: center;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .auth-section h3 {
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .auth-input {
            padding: 15px 20px;
            border: none;
            border-radius: 25px;
            margin: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 16px;
            width: 250px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .auth-input:focus {
            outline: none;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            margin: 10px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        .btn-back {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            box-shadow: 0 4px 15px rgba(78, 205, 196, 0.3);
            margin-bottom: 20px;
        }

        .btn-back:hover {
            box-shadow: 0 6px 20px rgba(78, 205, 196, 0.4);
        }

        .password-hint {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 235, 59, 0.2);
            border-radius: 15px;
            font-size: 0.9em;
            color: #fff;
            border: 1px solid rgba(255, 235, 59, 0.3);
        }

        /* Список альбомов */
        .albums-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .album-item {
            background: rgba(255, 255, 255, 0.12);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s ease;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            position: relative;
            overflow: hidden;
        }

        .album-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .album-item:hover::before {
            left: 100%;
        }

        .album-item:hover {
            transform: translateY(-10px) scale(1.02);
            background: rgba(255, 255, 255, 0.18);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .album-icon {
            font-size: 70px;
            margin-bottom: 15px;
            display: block;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .album-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 8px;
            color: #fff;
        }

        .album-info {
            color: #e0e0e0;
            margin-bottom: 15px;
            font-size: 1em;
        }

        .album-stats {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 0.9em;
            color: #ccc;
        }

        /* Страница альбома */
        .album-page {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            padding: 35px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .album-header {
            display: flex;
            align-items: center;
            margin-bottom: 35px;
            padding-bottom: 25px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .album-cover {
            font-size: 100px;
            margin-right: 30px;
            filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.4));
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .album-details h2 {
            font-size: 2.5em;
            margin-bottom: 8px;
            background: linear-gradient(45deg, #ffeb3b, #ff9800);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .album-details p {
            color: #e0e0e0;
            margin-bottom: 5px;
            font-size: 1.1em;
        }

        .album-actions {
            margin-top: 20px;
        }

        .btn-play-all {
            background: linear-gradient(45deg, #4caf50, #45a049);
            margin-right: 15px;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .btn-download-album {
            background: linear-gradient(45deg, #ff9800, #f57c00);
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }

        /* Список треков */
        .tracks-list {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .track-item {
            display: flex;
            align-items: center;
            padding: 18px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .track-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(8px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .track-item.playing {
            background: linear-gradient(45deg, rgba(255, 235, 59, 0.2), rgba(255, 152, 0, 0.2));
            border-left: 4px solid #ffeb3b;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 10px rgba(255, 235, 59, 0.5); }
            to { box-shadow: 0 0 20px rgba(255, 235, 59, 0.3); }
        }

        .track-number {
            background: rgba(255, 255, 255, 0.2);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            font-weight: bold;
            font-size: 1em;
        }

        .track-info {
            flex: 1;
        }

        .track-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .track-duration {
            color: #bbb;
            font-size: 1em;
        }

        .track-actions {
            display: flex;
            gap: 12px;
        }

        .btn-small {
            padding: 8px 15px;
            font-size: 0.85em;
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-small:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* Плеер */
        .player-section {
            background: rgba(0, 0, 0, 0.5);
            padding: 25px;
            border-radius: 25px;
            position: sticky;
            bottom: 20px;
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .player-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .current-track-title {
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 8px;
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .current-album-info {
            color: #ccc;
            font-size: 1em;
        }

        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.15);
            border: none;
            border-radius: 50%;
            width: 55px;
            height: 55px;
            color: white;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .play-btn {
            width: 70px;
            height: 70px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            font-size: 28px;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.2);
            height: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            cursor: pointer;
            overflow: hidden;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            height: 100%;
            width: 0%;
            transition: width 0.1s ease;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(78, 205, 196, 0.4);
        }

        .time-info {
            display: flex;
            justify-content: space-between;
            font-size: 1em;
            color: #ccc;
            font-weight: 500;
        }

        /* Утилиты */
        .hidden {
            display: none !important;
        }

        .auth-status {
            text-align: center;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 1.1em;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .auth-success {
            background: rgba(76, 175, 80, 0.25);
            color: #4caf50;
            border: 2px solid rgba(76, 175, 80, 0.4);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.2);
        }

        .auth-error {
            background: rgba(244, 67, 54, 0.25);
            color: #f44336;
            border: 2px solid rgba(244, 67, 54, 0.4);
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.2);
        }

        /* Адаптивность */
        @media (max-width: 768px) {
            .albums-list {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }
            
            .album-header {
                flex-direction: column;
                text-align: center;
            }
            
            .album-cover {
                margin-right: 0;
                margin-bottom: 20px;
            }
            
            .player-controls {
                flex-wrap: wrap;
                gap: 15px;
            }
            
            .track-item {
                padding: 15px 20px;
            }
            
            .track-actions {
                flex-direction: column;
                gap: 8px;
            }

            .auth-input {
                width: 90%;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .albums-list {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>🎵 Моя Музыкальная Коллекция</h1>
            <p>Персональная коллекция альбомов и треков</p>
        </header>

        <!-- Авторизация -->
        <div class="auth-section" id="authSection">
            <h3>🔐 Авторизация для друзей</h3>
            <input type="password" id="passwordInput" class="auth-input" placeholder="Введите пароль" onkeypress="handleEnter(event)">
            <br>
            <button onclick="authenticate()" class="btn">Войти</button>
            
            <div class="password-hint">
                💡 Подсказка: попробуйте один из паролей:<br>
                <strong>music2024</strong>, <strong>друзья123</strong> или <strong>111</strong>
            </div>
        </div>

        <div id="authStatus" class="auth-status hidden"></div>

        <!-- Основной контент -->
        <div id="musicContent" class="hidden">
            
            <!-- Список альбомов -->
            <div id="albumsListView">
                <div class="albums-list" id="albumsList">
                    <!-- Альбомы загружаются сюда -->
                </div>
            </div>

            <!-- Страница альбома -->
            <div id="albumPageView" class="hidden">
                <button onclick="showAlbumsList()" class="btn btn-back">← Назад к альбомам</button>
                
                <div class="album-page">
                    <div class="album-header">
                        <div class="album-cover" id="albumPageCover">🎵</div>
                        <div class="album-details">
                            <h2 id="albumPageTitle">Название альбома</h2>
                            <p><strong>Исполнитель:</strong> <span id="albumPageArtist"></span></p>
                            <p><strong>Год:</strong> <span id="albumPageYear"></span></p>
                            <p><strong>Треков:</strong> <span id="albumPageTracksCount"></span></p>
                            
                            <div class="album-actions">
                                <button class="btn btn-play-all" onclick="playCurrentAlbum()">▶ Играть весь альбом</button>
                                <button class="btn btn-download-album" onclick="downloadCurrentAlbum()">⬇ Скачать альбом</button>
                            </div>
                        </div>
                    </div>

                    <div class="tracks-list" id="tracksList">
                        <!-- Треки загружаются сюда -->
                    </div>
                </div>
            </div>

            <!-- Плеер -->
            <div class="player-section">
                <div class="player-info">
                    <div class="current-track-title" id="currentTrack">Выберите трек для воспроизведения</div>
                    <div class="current-album-info" id="currentAlbum"></div>
                </div>
                
                <div class="player-controls">
                    <button class="control-btn" onclick="previousTrack()" title="Предыдущий трек">⏮</button>
                    <button class="control-btn play-btn" id="playBtn" onclick="togglePlay()" title="Играть/Пауза">▶</button>
                    <button class="control-btn" onclick="nextTrack()" title="Следующий трек">⏭</button>
                    <button class="control-btn" onclick="toggleShuffle()" id="shuffleBtn" title="Перемешать">🔀</button>
                    <button class="control-btn" onclick="toggleRepeat()" id="repeatBtn" title="Повтор">🔁</button>
                </div>

                <div class="progress-container" onclick="setProgress(event)">
                    <div class="progress-bar" id="progressBar"></div>
                </div>

                <div class="time-info">
                    <span id="currentTime">0:00</span>
                    <span id="duration">0:00</span>
                </div>

                <audio id="audioPlayer" preload="metadata"></audio>
            </div>
        </div>
    </div>

    <script>
        // Конфигурация
        const config = {
            passwords: ['music2024', 'друзья123', '111'], // Пароли для доступа
            albums: [
                {
                    id: 'album1',
                    title: 'Летние Мелодии',
                    artist: 'Мой Проект',
                    year: '2024',
                    icon: '🌅',
                    tracks: [
                        { id: 1, title: 'Утреннее Солнце', file: 'https://raw.githubusercontent.com/christian-word/info-pages/main/media/Justification_By_Faith.mp3', duration: '3:45' },
                        { id: 2, title: 'Вечерний Бриз', file: 'audio/album1/track2.mp3', duration: '4:12' },
                        { id: 3, title: 'Ночные Огни', file: 'audio/album1/track3.mp3', duration: '3:58' },
                        { id: 4, title: 'Морской Прибой', file: 'audio/album1/track4.mp3', duration: '5:23' }
                    ]
                },
                {
                    id: 'album2',
                    title: 'Осенние Ритмы',
                    artist: 'Мой Проект',
                    year: '2024',
                    icon: '🍂',
                    tracks: [
                        { id: 5, title: 'Желтые Листья', file: 'audio/album2/track1.mp3', duration: '4:23' },
                        { id: 6, title: 'Дождливый День', file: 'audio/album2/track2.mp3', duration: '3:37' },
                        { id: 7, title: 'Теплый Чай', file: 'audio/album2/track3.mp3', duration: '4:01' },
                        { id: 8, title: 'Камин', file: 'audio/album2/track4.mp3', duration: '5:15' }
                    ]
                },
                {
                    id: 'album3',
                    title: 'Зимние Грезы',
                    artist: 'Мой Проект',
                    year: '2023',
                    icon: '❄️',
                    tracks: [
                        { id: 9, title: 'Снегопад', file: 'audio/album3/track1.mp3', duration: '4:45' },
                        { id: 10, title: 'Новый Год', file: 'audio/album3/track2.mp3', duration: '3:28' },
                        { id: 11, title: 'Зимняя Сказка', file: 'audio/album3/track3.mp3', duration: '5:12' }
                    ]
                },
                {
                    id: 'album4',
                    title: 'Весенний Джем',
                    artist: 'Мой Проект',
                    year: '2024',
                    icon: '🌸',
                    tracks: [
                        { id: 12, title: 'Первые Цветы', file: 'audio/album4/track1.mp3', duration: '3:56' },
                        { id: 13, title: 'Птичьи Трели', file: 'audio/album4/track2.mp3', duration: '4:18' },
                        { id: 14, title: 'Майский Дождь', file: 'audio/album4/track3.mp3', duration: '3:42' },
                        { id: 15, title: 'Солнечный Луч', file: 'audio/album4/track4.mp3', duration: '4:33' }
                    ]
                }
            ]
        };

        // Глобальные переменные
        let isAuthenticated = false;
        let currentPlaylist = [];
        let currentTrackIndex = 0;
        let currentAlbumId = null;
        let isPlaying = false;
        let isShuffled = false;
        let repeatMode = 0; // 0 - нет, 1 - все, 2 - один трек
        let audioPlayer = null;

        // Инициализация
        document.addEventListener('DOMContentLoaded', function() {
            audioPlayer = document.getElementById('audioPlayer');
            setupAudioEvents();
            console.log('🎵 Музыкальная коллекция загружена!');
            console.log('💡 Доступные пароли: music2024, друзья123, 111');
        });

        // Обработка Enter в поле пароля
        function handleEnter(event) {
            if (event.key === 'Enter') {
                authenticate();
            }
        }

        // Авторизация
        function authenticate() {
            const password = document.getElementById('passwordInput').value.trim();
            const authStatus = document.getElementById('authStatus');
            
            if (!password) {
                showAuthMessage('❌ Введите пароль!', 'error');
                return;
            }
            
            if (config.passwords.includes(password)) {
                isAuthenticated = true;
                showAuthMessage('✅ Авторизация успешна! Добро пожаловать!', 'success');
                
                setTimeout(() => {
                    document.getElementById('authSection').classList.add('hidden');
                    document.getElementById('musicContent').classList.remove('hidden');
                    loadAlbumsList();
                }, 1500);
                
            } else {
                showAuthMessage('❌ Неверный пароль. Попробуйте еще раз.', 'error');
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordInput').focus();
            }
        }

        function showAuthMessage(message, type) {
            const authStatus = document.getElementById('authStatus');
            authStatus.textContent = message;
            authStatus.className = `auth-status auth-${type}`;
            authStatus.classList.remove('hidden');
        }

        // Загрузка списка альбомов
        function loadAlbumsList() {
            const albumsList = document.getElementById('albumsList');
            albumsList.innerHTML = '';

            config.albums.forEach(album => {
                const albumItem = document.createElement('div');
                albumItem.className = 'album-item';
                albumItem.onclick = () => showAlbum(album.id);
                
                const totalDuration = calculateTotalDuration(album.tracks);
                
                albumItem.innerHTML = `
                    <div class="album-icon">${album.icon}</div>
                    <div class="album-title">${album.title}</div>
                    <div class="album-info">
                        <strong>${album.artist}</strong><br>
                        ${album.year}
                    </div>
                    <div class="album-stats">
                        ${album.tracks.length} треков • ${totalDuration}
                    </div>
                `;
                
                albumsList.appendChild(albumItem);
            });
        }

        // Показать альбом
        function showAlbum(albumId) {
            const album = config.albums.find(a => a.id === albumId);
            if (!album) return;

            currentAlbumId = albumId;

            // Скрыть список альбомов, показать страницу альбома
            document.getElementById('albumsListView').classList.add('hidden');
            document.getElementById('albumPageView').classList.remove('hidden');

            // Заполнить информацию об альбоме
            document.getElementById('albumPageCover').textContent = album.icon;
            document.getElementById('albumPageTitle').textContent = album.title;
            document.getElementById('albumPageArtist').textContent = album.artist;
            document.getElementById('albumPageYear').textContent = album.year;
            document.getElementById('albumPageTracksCount').textContent = album.tracks.length;

            // Загрузить список треков
            loadTracksList(album);
        }

        // Показать список альбомов
        function showAlbumsList() {
            document.getElementById('albumPageView').classList.add('hidden');
            document.getElementById('albumsListView').classList.remove('hidden');
            currentAlbumId = null;
        }

        // Загрузка списка треков
        function loadTracksList(album) {
            const tracksList = document.getElementById('tracksList');
            tracksList.innerHTML = '';

            album.tracks.forEach((track, index) => {
                const trackItem = document.createElement('div');
                trackItem.className = 'track-item';
                trackItem.onclick = () => playTrack(album.id, track.id);
                
                trackItem.innerHTML = `
                    <div class="track-number">${index + 1}</div>
                    <div class="track-info">
                        <div class="track-title">${track.title}</div>
                        <div class="track-duration">${track.duration}</div>
                    </div>
                    <div class="track-actions">
                        <button class="btn-small" onclick="event.stopPropagation(); playTrack('${album.id}', ${track.id})" title="Играть">▶</button>
                        <button class="btn-small" onclick="event.stopPropagation(); downloadTrack('${album.id}', ${track.id})" title="Скачать">⬇</button>
                    </div>
                `;
                
                tracksList.appendChild(trackItem);
            });
        }

        // Воспроизведение
        function playTrack(albumId, trackId) {
            const album = config.albums.find(a => a.id === albumId);
            const track = album.tracks.find(t => t.id === trackId);
            
            if (!track) return;

            currentPlaylist = album.tracks;
            currentTrackIndex = album.tracks.findIndex(t => t.id === trackId);
            
            loadAndPlayTrack(track, album);
            updateTrackHighlight();
        }

        function playCurrentAlbum() {
            if (!currentAlbumId) return;
            
            const album = config.albums.find(a => a.id === currentAlbumId);
            if (!album || album.tracks.length === 0) return;

            playTrack(currentAlbumId, album.tracks[0].id);
        }

        function loadAndPlayTrack(track, album) {
            document.getElementById('currentTrack').textContent = track.title;
            document.getElementById('currentAlbum').textContent = `${album.title} - ${album.artist}`;
            
            // В демо версии показываем уведомление
            console.log(`🎵 Воспроизводится: ${track.title} из альбома ${album.title}`);
            
            // В реальной версии здесь будет:
             audioPlayer.src = track.file;
             audioPlayer.play().catch(e => console.error('Ошибка воспроизведения:', e));
            
            isPlaying = true;
            updatePlayButton();
            simulateProgress(); // Для демонстрации
        }

        // Симуляция прогресса для демо
        let progressInterval = null;
        function simulateProgress() {
            clearInterval(progressInterval);
            let progress = 0;
            const duration = 240; // 4 минуты для демо
            
            document.getElementById('duration').textContent = formatTime(duration);
            
            progressInterval = setInterval(() => {
                if (isPlaying && progress < duration) {
                    progress += 1;
                    const progressPercent = (progress / duration) * 100;
                    document.getElementById('progressBar').style.width = progressPercent + '%';
                    document.getElementById('currentTime').textContent = formatTime(progress);
                } else if (progress >= duration) {
                    handleTrackEnd();
                }
            }, 1000);
        }

        // Управление плеером
        function togglePlay() {
            if (currentPlaylist.length === 0) {
                alert('🎵 Сначала выберите трек для воспроизведения!');
                return;
            }

            isPlaying = !isPlaying;
            updatePlayButton();
            
            if (isPlaying) {
                console.log('▶ Воспроизведение');
                // audioPlayer.play();
            } else {
                console.log('⏸ Пауза');
                // audioPlayer.pause();
            }
        }

        function previousTrack() {
            if (currentPlaylist.length === 0) return;
            
            if (isShuffled) {
                currentTrackIndex = Math.floor(Math.random() * currentPlaylist.length);
            } else {
                currentTrackIndex = (currentTrackIndex - 1 + currentPlaylist.length) % currentPlaylist.length;
            }
            
            playCurrentTrack();
        }

        function nextTrack() {
            if (currentPlaylist.length === 0) return;
            
            if (repeatMode === 2) {
                // Повтор одного трека
                playCurrentTrack();
                return;
            }
            
            if (isShuffled) {
                currentTrackIndex = Math.floor(Math.random() * currentPlaylist.length);
            } else {
                currentTrackIndex = (currentTrackIndex + 1) % currentPlaylist.length;
            }
            
            playCurrentTrack();
        }

        function playCurrentTrack() {
            if (currentPlaylist.length === 0) return;
            
            const track = currentPlaylist[currentTrackIndex];
            const album = config.albums.find(a => a.tracks.some(t => t.id === track.id));
            
            loadAndPlayTrack(track, album);
            updateTrackHighlight();
        }

        function toggleShuffle() {
            isShuffled = !isShuffled;
            const shuffleBtn = document.getElementById('shuffleBtn');
            shuffleBtn.style.background = isShuffled ? 
                'linear-gradient(45deg, #4caf50, #45a049)' : 
                'rgba(255, 255, 255, 0.15)';
            console.log(isShuffled ? '🔀 Перемешивание включено' : '➡️ Обычный порядок');
        }

        function toggleRepeat() {
            repeatMode = (repeatMode + 1) % 3;
            const repeatBtn = document.getElementById('repeatBtn');
            
            switch (repeatMode) {
                case 0:
                    repeatBtn.textContent = '🔁';
                    repeatBtn.style.background = 'rgba(255, 255, 255, 0.15)';
                    console.log('🔁 Повтор выключен');
                    break;
                case 1:
                    repeatBtn.textContent = '🔁';
                    repeatBtn.style.background = 'linear-gradient(45deg, #ff9800, #f57c00)';
                    console.log('🔁 Повтор всех треков');
                    break;
                case 2:
                    repeatBtn.textContent = '🔂';
                    repeatBtn.style.background = 'linear-gradient(45deg, #9c27b0, #7b1fa2)';
                    console.log('🔂 Повтор одного трека');
                    break;
            }
        }

        // Обновление интерфейса
        function updatePlayButton() {
            const playBtn = document.getElementById('playBtn');
            playBtn.textContent = isPlaying ? '⏸' : '▶';
        }

        function updateTrackHighlight() {
            // Убираем выделение со всех треков
            document.querySelectorAll('.track-item').forEach(item => {
                item.classList.remove('playing');
            });
            
            // Добавляем выделение текущему треку
            if (currentPlaylist.length > 0) {
                const trackItems = document.querySelectorAll('.track-item');
                trackItems.forEach((item, index) => {
                    if (index === currentTrackIndex) {
                        item.classList.add('playing');
                    }
                });
            }
        }

        // Скачивание
        function downloadCurrentAlbum() {
            if (!isAuthenticated) {
                alert('❌ Необходима авторизация для скачивания');
                return;
            }
            
            if (!currentAlbumId) {
                alert('❌ Сначала выберите альбом');
                return;
            }
            
            const album = config.albums.find(a => a.id === currentAlbumId);
            alert(`⬇️ Скачивание альбома "${album.title}" начнется в реальной версии.\n\n📁 Будут загружены ${album.tracks.length} треков в ZIP архиве.`);
            
            console.log(`Скачивание альбома: ${album.title}`);
        }

        function downloadTrack(albumId, trackId) {
            if (!isAuthenticated) {
                alert('❌ Необходима авторизация для скачивания');
                return;
            }
            
            const album = config.albums.find(a => a.id === albumId);
            const track = album.tracks.find(t => t.id === trackId);
            
            alert(`⬇️ Скачивание трека "${track.title}" начнется в реальной версии.`);
            
            console.log(`Скачивание трека: ${track.title}`);
        }

        // Вспомогательные функции
        function calculateTotalDuration(tracks) {
            let totalMinutes = 0;
            let totalSeconds = 0;
            
            tracks.forEach(track => {
                const [minutes, seconds] = track.duration.split(':').map(Number);
                totalMinutes += minutes;
                totalSeconds += seconds;
            });
            
            totalMinutes += Math.floor(totalSeconds / 60);
            totalSeconds = totalSeconds % 60;
            
            return `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
        }

        function formatTime(seconds) {
            if (!seconds || isNaN(seconds)) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Настройка аудио событий
        function setupAudioEvents() {
            if (!audioPlayer) return;
            
            audioPlayer.addEventListener('timeupdate', updateProgress);
            audioPlayer.addEventListener('ended', handleTrackEnd);
            audioPlayer.addEventListener('loadedmetadata', updateDuration);
            audioPlayer.addEventListener('error', handleAudioError);
            audioPlayer.addEventListener('play', () => {
                isPlaying = true;
                updatePlayButton();
            });
            audioPlayer.addEventListener('pause', () => {
                isPlaying = false;
                updatePlayButton();
            });
            audioPlayer.addEventListener('loadstart', () => {
                console.log('🔄 Загрузка аудио...');
            });
            audioPlayer.addEventListener('canplaythrough', () => {
                console.log('✅ Аудио готово к воспроизведению');
            });
        }

        function updateProgress() {
            if (audioPlayer.duration) {
                const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
                document.getElementById('progressBar').style.width = progress + '%';
                document.getElementById('currentTime').textContent = formatTime(audioPlayer.currentTime);
            }
        }

        function updateDuration() {
            document.getElementById('duration').textContent = formatTime(audioPlayer.duration);
        }

        function setProgress(event) {
            const progressContainer = event.currentTarget;
            const clickX = event.offsetX;
            const width = progressContainer.offsetWidth;
            
            // В демо версии просто показываем позицию
            const newProgress = (clickX / width) * 100;
            document.getElementById('progressBar').style.width = newProgress + '%';
            
            console.log(`Перемотка на ${Math.round(newProgress)}%`);
            
            // В реальной версии:
             if (audioPlayer.duration) {
                 const newTime = (clickX / width) * audioPlayer.duration;
                 audioPlayer.currentTime = newTime;
             }
        }

        function handleTrackEnd() {
            clearInterval(progressInterval);
            
            if (repeatMode === 2) {
                // Повтор текущего трека
                playCurrentTrack();
            } else if (repeatMode === 1 || currentTrackIndex < currentPlaylist.length - 1) {
                // Переход к следующему треку
                nextTrack();
            } else {
                // Конец плейлиста
                isPlaying = false;
                updatePlayButton();
                document.getElementById('progressBar').style.width = '0%';
                document.getElementById('currentTime').textContent = '0:00';
                console.log('🏁 Плейлист завершен');
            }
        }

        function handleAudioError(e) {
            console.error('Ошибка воспроизведения аудио:', e);
            alert('❌ Ошибка воспроизведения. Проверьте, что аудиофайл доступен.');
        }

        // Обработка клавиш
        document.addEventListener('keydown', function(e) {
            // Игнорируем, если фокус на поле ввода
            if (e.target.tagName === 'INPUT') return;
            
            switch(e.code) {
                case 'Space':
                    e.preventDefault();
                    togglePlay();
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    previousTrack();
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    nextTrack();
                    break;
                case 'Escape':
                    if (!document.getElementById('albumPageView').classList.contains('hidden')) {
                        showAlbumsList();
                    }
                    break;
                case 'KeyS':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        toggleShuffle();
                    }
                    break;
                case 'KeyR':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        toggleRepeat();
                    }
                    break;
            }
        });

        // Инициализация при загрузке страницы
        window.addEventListener('load', function() {
            console.log('🎵 Музыкальная коллекция полностью загружена!');
            console.log('💡 Горячие клавиши:');
            console.log('   Пробел - Play/Pause');
            console.log('   ← → - Предыдущий/Следующий трек');
            console.log('   Escape - Назад к списку альбомов');
            console.log('   Ctrl+S - Переключить перемешивание');
            console.log('   Ctrl+R - Переключить повтор');
            console.log('🔑 Пароли: music2024, друзья123, 111');
            
            // Фокус на поле пароля
            document.getElementById('passwordInput').focus();
        });
    </script>
</body>
</html>